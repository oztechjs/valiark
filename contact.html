<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>お問い合わせ - VALIARK</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Montserrat:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Common Header Container -->
    <div id="header-container"></div>

    <!-- Page Header -->
    <section class="page-header">
      <div class="container">
        <h1 class="page-title">お問い合わせ</h1>
        <p class="page-subtitle">Contact</p>
      </div>
    </section>

    <!-- Trust Strip (portfolio highlights) -->
    <section class="results-strip">
      <div class="container results-container">
        <div class="result-item">
          <div class="result-number">★5</div>
          <div class="result-label">App Store評価</div>
        </div>
        <div class="result-item">
          <div class="result-number">¥2.5M</div>
          <div class="result-label">受託規模</div>
        </div>
        <div class="result-item">
          <div class="result-number">Expo 2025</div>
          <div class="result-label">出展実績</div>
        </div>
        <div class="result-item">
          <div class="result-number">2ヶ月</div>
          <div class="result-label">初リリースまで</div>
        </div>
      </div>
    </section>

    <!-- Contact Introduction -->
    <section class="contact-intro section">
      <div class="container">
        <h2 class="section-title">お気軽にご相談ください</h2>
        <p class="section-text large">
          AI導入やDX化に関するご相談、具体的なプロジェクトのご依頼、VALIARKへの参加希望など、どんなことでもお気軽にお問い合わせください。専門スタッフが丁寧にお答えいたします。
        </p>
      </div>
    </section>

    <!-- Contact Form Section -->
    <section class="contact-form-section section bg-light">
      <div class="container">
        <div class="contact-form-container">
          <form
            class="contact-form"
            id="contactForm"
            data-email-src="config/contact_email.html"
            data-bcc-src="config/contact_bcc_email.html"
            method="POST"
          >
            <!-- FormSubmit hidden controls -->
            <input
              type="hidden"
              name="_subject"
              value="【VALIARKサイト】お問い合わせ"
            />
            <input type="hidden" name="_captcha" value="false" />
            <input
              type="hidden"
              name="_next"
              value="https://oztechjs.github.io/valiark/thanks.html"
            />
            <input
              type="text"
              name="_honey"
              style="display: none"
              tabindex="-1"
              autocomplete="off"
            />
            <div class="form-group">
              <label for="inquiryType" class="form-label"
                >お問い合わせ種別 <span class="required">*</span></label
              >
              <div class="radio-group">
                <label class="radio-label">
                  <input
                    type="radio"
                    name="inquiryType"
                    value="business"
                    required
                  />
                  <span class="radio-custom"></span>
                  ご依頼・ご相談（企業の方）
                </label>
                <label class="radio-label">
                  <input
                    type="radio"
                    name="inquiryType"
                    value="recruitment"
                    required
                  />
                  <span class="radio-custom"></span>
                  参加希望（阪大生の方）
                </label>
                <label class="radio-label">
                  <input
                    type="radio"
                    name="inquiryType"
                    value="other"
                    required
                  />
                  <span class="radio-custom"></span>
                  その他
                </label>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="lastName" class="form-label"
                  >姓 <span class="required">*</span></label
                >
                <input
                  type="text"
                  id="lastName"
                  name="lastName"
                  class="form-input"
                  required
                />
              </div>
              <div class="form-group">
                <label for="firstName" class="form-label"
                  >名 <span class="required">*</span></label
                >
                <input
                  type="text"
                  id="firstName"
                  name="firstName"
                  class="form-input"
                  required
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="email" class="form-label"
                  >メールアドレス <span class="required">*</span></label
                >
                <input
                  type="email"
                  id="email"
                  name="email"
                  class="form-input"
                  required
                />
              </div>
              <div class="form-group">
                <label for="phone" class="form-label">電話番号</label>
                <input type="tel" id="phone" name="phone" class="form-input" />
              </div>
            </div>

            <div class="form-group" id="companyGroup">
              <label for="company" class="form-label">会社名・団体名</label>
              <input
                type="text"
                id="company"
                name="company"
                class="form-input"
              />
            </div>

            <div class="form-group" id="positionGroup">
              <label for="position" class="form-label">役職・部署</label>
              <input
                type="text"
                id="position"
                name="position"
                class="form-input"
              />
            </div>

            <div class="form-group" id="facultyGroup" style="display: none">
              <label for="faculty" class="form-label">学部・学科</label>
              <input
                type="text"
                id="faculty"
                name="faculty"
                class="form-input"
              />
            </div>

            <div class="form-group" id="gradeGroup" style="display: none">
              <label for="grade" class="form-label">学年</label>
              <select id="grade" name="grade" class="form-select">
                <option value="">選択してください</option>
                <option value="1">1年生</option>
                <option value="2">2年生</option>
                <option value="3">3年生</option>
                <option value="4">4年生</option>
                <option value="master1">修士1年</option>
                <option value="master2">修士2年</option>
                <option value="doctor">博士課程</option>
              </select>
            </div>

            <div class="form-group">
              <label for="subject" class="form-label"
                >件名 <span class="required">*</span></label
              >
              <input
                type="text"
                id="subject"
                name="subject"
                class="form-input"
                required
              />
            </div>

            <div class="form-group">
              <label for="message" class="form-label"
                >お問い合わせ内容 <span class="required">*</span></label
              >
              <textarea
                id="message"
                name="message"
                class="form-textarea"
                rows="8"
                required
                placeholder="具体的なご相談内容、プロジェクトの概要、期待される成果物、予算感、スケジュールなどをご記入ください。"
              ></textarea>
            </div>

            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" name="privacy" required />
                <span class="checkbox-custom"></span>
                <a href="#" class="privacy-link">プライバシーポリシー</a
                >に同意します <span class="required">*</span>
              </label>
            </div>

            <div id="formStatus" class="form-status" aria-live="polite"></div>
            <div class="form-submit">
              <button
                type="submit"
                class="btn btn-primary btn-large"
                id="contactSubmit"
                data-label="送信する"
                disabled
              >
                送信する
              </button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- Contact Information -->
    <section class="contact-info section">
      <div class="container">
        <div class="contact-info-grid">
          <div class="contact-info-item">
            <div class="contact-info-icon">
              <svg
                width="48"
                height="48"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z"
                  stroke="#FF0000"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <polyline
                  points="22,6 12,13 2,6"
                  stroke="#FF0000"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </div>
            <h3 class="contact-info-title">メールでのお問い合わせ</h3>
            <p class="contact-info-description">
              24時間受付中。通常2営業日以内にご返信いたします。
            </p>
            <a href="mailto:contact@valiark.jp" class="contact-info-link"
              >contact@valiark.jp</a
            >
          </div>

          <div class="contact-info-item">
            <div class="contact-info-icon">
              <svg
                width="48"
                height="48"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M22 16.92V19.92C22.0011 20.1985 21.9441 20.4742 21.8325 20.7293C21.7209 20.9845 21.5573 21.2136 21.3521 21.4019C21.1468 21.5901 20.9046 21.7335 20.6407 21.8227C20.3769 21.9119 20.0974 21.9451 19.82 21.92C16.7428 21.5856 13.787 20.5341 11.19 18.85C8.77383 17.3147 6.72534 15.2662 5.19 12.85C3.49998 10.2412 2.44818 7.27099 2.12 4.18C2.09501 3.90347 2.12788 3.62476 2.21649 3.36162C2.3051 3.09849 2.44748 2.85669 2.63519 2.65162C2.82291 2.44655 3.05098 2.28271 3.30503 2.17052C3.55909 2.05833 3.83396 2.00026 4.11 2H7.11C7.59531 1.99522 8.06674 2.16708 8.43935 2.48353C8.81196 2.79999 9.06263 3.23945 9.14 3.72C9.28393 4.68007 9.54781 5.61273 9.92 6.5C10.0618 6.88792 10.0944 7.31048 10.0145 7.72024C9.93463 8.13 9.74532 8.50875 9.47 8.82L8.09 10.2C9.51355 12.6793 11.5207 14.6864 14 16.11L15.38 14.73C15.6912 14.4547 16.07 14.2654 16.4798 14.1855C16.8895 14.1056 17.3121 14.1382 17.7 14.28C18.5873 14.6522 19.5199 14.9161 20.48 15.06C20.9658 15.1381 21.4094 15.3936 21.7265 15.7736C22.0435 16.1535 22.2131 16.6307 22.21 17.12L22 16.92Z"
                  stroke="#FF0000"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </div>
            <h3 class="contact-info-title">お急ぎの場合</h3>
            <p class="contact-info-description">
              緊急のご相談やお急ぎの案件については、まずはメールでご連絡ください。
            </p>
            <p class="contact-info-link">平日 10:00-18:00</p>
          </div>

          <div class="contact-info-item">
            <div class="contact-info-icon">
              <svg
                width="48"
                height="48"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21 10C21 17 12 23 12 23S3 17 3 10C3 7.61305 3.94821 5.32387 5.63604 3.63604C7.32387 1.94821 9.61305 1 12 1C14.3869 1 16.6761 1.94821 18.3639 3.63604C20.0518 5.32387 21 7.61305 21 10Z"
                  stroke="#FF0000"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <circle
                  cx="12"
                  cy="10"
                  r="3"
                  stroke="#FF0000"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </div>
            <h3 class="contact-info-title">所在地</h3>
            <p class="contact-info-description">
              大阪大学を拠点として活動しています。
            </p>
            <p class="contact-info-link">大阪府吹田市</p>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <section class="faq-section section bg-light">
      <div class="container">
        <h2 class="section-title">よくあるご質問</h2>
        <div class="faq-list">
          <div class="faq-item">
            <h3 class="faq-question">
              Q. プロジェクトの費用はどのくらいかかりますか？
            </h3>
            <p class="faq-answer">
              プロジェクトの規模や内容によって異なりますが、学生ならではのコストパフォーマンスを実現しています。まずはお気軽にご相談ください。無料でお見積もりを作成いたします。
            </p>
          </div>
          <div class="faq-item">
            <h3 class="faq-question">
              Q. どのような業界の案件に対応できますか？
            </h3>
            <p class="faq-answer">
              製造業、小売業、金融業、医療・ヘルスケア、教育など、様々な業界のAI・DX案件に対応可能です。業界固有の課題についても、研究を通じて培った知識と技術で解決策を提案します。
            </p>
          </div>
          <div class="faq-item">
            <h3 class="faq-question">
              Q. プロジェクトの期間はどのくらいですか？
            </h3>
            <p class="faq-answer">
              プロジェクトの内容により異なりますが、小規模なものは1-2ヶ月、大規模なものは3-6ヶ月程度を想定しています。スケジュールについてもお気軽にご相談ください。
            </p>
          </div>
          <div class="faq-item">
            <h3 class="faq-question">
              Q. VALIARKに参加するにはどうすればよいですか？
            </h3>
            <p class="faq-answer">
              大阪大学の学生であれば、どなたでも参加可能です。プログラミング経験や専攻は問いません。まずはお問い合わせフォームから「参加希望」を選択してご連絡ください。
            </p>
          </div>
          <div class="faq-item">
            <h3 class="faq-question">
              Q. 秘密保持契約（NDA）は締結できますか？
            </h3>
            <p class="faq-answer">
              はい、プロジェクト開始前に秘密保持契約を締結いたします。お客様の機密情報は厳重に管理し、プロジェクト終了後も適切に取り扱います。
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-logo">
            <img src="images/logo.png" alt="VALIARK" class="logo" />
          </div>
          <nav class="footer-nav">
            <a href="index.html" class="footer-link">ホーム</a>
            <a href="about.html" class="footer-link">私たちについて</a>
            <a href="services.html" class="footer-link">事業内容</a>
            <a href="works.html" class="footer-link">実績紹介</a>
            <a href="contact.html" class="footer-link">お問い合わせ</a>
          </nav>
        </div>
        <div class="footer-bottom">
          <p class="copyright">2025 VALIARK</p>
        </div>
      </div>
    </footer>

    <script src="js/header.js"></script>
    <script src="js/script.js"></script>
    <script>
      (function () {
        const form = document.getElementById("contactForm");
        if (!form) return;
        const mainSrc = form.getAttribute("data-email-src");
        const bccSrc = form.getAttribute("data-bcc-src");
        const submitBtn = document.getElementById("contactSubmit");
        const statusBox = document.getElementById("formStatus");

        function setStatus(msg, type) {
          if (!statusBox) return;
          statusBox.innerHTML = msg || ""; // allow inline <a> for fallback
          statusBox.className = "form-status " + (type || "");
        }

        setStatus("フォーム初期化中...", "info");

        const load = (url) =>
          fetch(url, { cache: "no-store" })
            .then((r) => r.text())
            .then((t) => (t || "").replace(/<!--.*?-->/g, "").trim());
        const isMail = (v) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);

        Promise.all([
          mainSrc ? load(mainSrc).catch(() => "") : "",
          bccSrc ? load(bccSrc).catch(() => "") : "",
        ])
          .then(([toEmail, bccEmail]) => {
            if (isMail(toEmail)) {
              form.setAttribute("action", `https://formsubmit.co/${toEmail}`);
              if (submitBtn) submitBtn.disabled = false;
              form.dataset.toEmail = toEmail;
              try {
                localStorage.setItem(
                  "contactFlowLog",
                  JSON.stringify({
                    t: Date.now(),
                    stage: "init-complete",
                    action: form.getAttribute("action"),
                  })
                );
              } catch (e) {}
              setStatus(
                "フォーム準備完了。必要事項を入力して送信してください。",
                "success"
              );
            } else {
              console.warn("Invalid primary contact email config");
              try {
                localStorage.setItem(
                  "contactFlowLog",
                  JSON.stringify({ t: Date.now(), stage: "init-failed" })
                );
              } catch (e) {}
              setStatus(
                "メール送信設定の読み込みに失敗しました。時間をおいて再読み込みしてください。",
                "error"
              );
            }
            if (isMail(bccEmail)) {
              const hidden = document.createElement("input");
              hidden.type = "hidden";
              hidden.name = "_cc";
              hidden.value = bccEmail;
              form.appendChild(hidden);
            }
          })
          .catch((e) => {
            console.warn("Email config load failed:", e);
            try {
              localStorage.setItem(
                "contactFlowLog",
                JSON.stringify({ t: Date.now(), stage: "init-error" })
              );
            } catch (e2) {}
            setStatus(
              "設定取得でエラーが発生しました。ネットワークをご確認のうえ再読込してください。",
              "error"
            );
          });

        setTimeout(() => {
          if (!form.getAttribute("action")) {
            setStatus(
              "まだ送信先が確定していません。通信が遅い可能性があります。再読み込みをお試しください。",
              "warn"
            );
            try {
              localStorage.setItem(
                "contactFlowLog",
                JSON.stringify({ t: Date.now(), stage: "no-action-timeout" })
              );
            } catch (e) {}
          }
        }, 5000);
      })();
    </script>
    <script>
      (function () {
        const form = document.getElementById("contactForm");
        const submitBtn = document.getElementById("contactSubmit");
        const statusBox = document.getElementById("formStatus");
        if (!form || !submitBtn) return;

        function setStatus(msg, type) {
          if (!statusBox) return;
          statusBox.innerHTML = msg || "";
          statusBox.className = "form-status " + (type || "");
        }

        form.addEventListener("submit", function (e) {
          if (submitBtn.classList.contains("loading"))
            return e.preventDefault();
          if (!form.checkValidity()) {
            e.preventDefault();
            setStatus("未入力/形式エラーの項目があります。", "error");
            form.classList.add("was-validated");
            const firstInvalid = form.querySelector(":invalid");
            if (firstInvalid) firstInvalid.focus();
            try {
              localStorage.setItem(
                "contactFlowLog",
                JSON.stringify({ t: Date.now(), stage: "validation-failed" })
              );
            } catch (e2) {}
            return;
          }
          const useAjax = !!window.FORM_AJAX_DEBUG;
          submitBtn.disabled = true;
          submitBtn.classList.add("loading");
          submitBtn.innerHTML =
            '<span class="btn-spinner" aria-hidden="true"></span><span>送信中...</span>';
          setStatus("送信中...", "info");
          try {
            localStorage.setItem(
              "contactFlowLog",
              JSON.stringify({ t: Date.now(), stage: "submit-start" })
            );
          } catch (e3) {}

          if (useAjax && form.action.includes("formsubmit.co/")) {
            e.preventDefault();
            const emailPart = form.action.split("formsubmit.co/")[1];
            const ajaxUrl = `https://formsubmit.co/ajax/${emailPart}`;
            const fd = new FormData(form);
            fetch(ajaxUrl, {
              method: "POST",
              body: fd,
              headers: { Accept: "application/json" },
            })
              .then(async (res) => {
                const text = await res.text();
                const ok = res.ok;
                try {
                  localStorage.setItem(
                    "contactFlowLog",
                    JSON.stringify({
                      t: Date.now(),
                      stage: ok ? "ajax-success" : "ajax-fail",
                      status: res.status,
                    })
                  );
                  localStorage.setItem(
                    "contactFlowDebugResponse",
                    text.slice(0, 2000)
                  );
                } catch (_) {}
                if (ok) {
                  setStatus("送信完了。リダイレクトします...", "success");
                  setTimeout(() => {
                    window.location.href =
                      form.querySelector('input[name="_next"]').value ||
                      "thanks.html";
                  }, 800);
                } else {
                  submitBtn.disabled = false;
                  submitBtn.classList.remove("loading");
                  submitBtn.innerHTML = submitBtn.dataset.label || "送信する";
                  setStatus(
                    `送信失敗 (status ${res.status})。数分後に再試行してください。`,
                    "error"
                  );
                }
              })
              .catch((err) => {
                console.error("AJAX submit error", err);
                try {
                  localStorage.setItem(
                    "contactFlowLog",
                    JSON.stringify({
                      t: Date.now(),
                      stage: "ajax-error",
                      message: String(err),
                    })
                  );
                } catch (_) {}
                submitBtn.disabled = false;
                submitBtn.classList.remove("loading");
                submitBtn.innerHTML = submitBtn.dataset.label || "送信する";
                setStatus(
                  "送信処理でエラーが発生しました。接続状況を確認し再試行してください。",
                  "error"
                );
              });
            return;
          }

          const stage1 = setTimeout(() => {
            if (
              document.visibilityState === "visible" &&
              submitBtn.classList.contains("loading")
            ) {
              setStatus(
                "まだ処理中です…少しお待ちください (回線/サービス応答待ち)",
                "info"
              );
              try {
                localStorage.setItem(
                  "contactFlowLog",
                  JSON.stringify({ t: Date.now(), stage: "delay-stage1" })
                );
              } catch (_) {}
            }
          }, 10000);
          const stage2 = setTimeout(() => {
            if (
              document.visibilityState === "visible" &&
              submitBtn.classList.contains("loading")
            ) {
              const mail = form.dataset.toEmail || "contact@valiark.jp";
              setStatus(
                `送信が完了しないため遅延しています。ネットワークをご確認ください。<br>解消しない場合は <a href="mailto:${mail}?subject=%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B(フォーム遅延)">直接メール</a> もご利用ください。`,
                "warn"
              );
              if (statusBox) statusBox.style.fontSize = "0.9rem";
              try {
                localStorage.setItem(
                  "contactFlowLog",
                  JSON.stringify({ t: Date.now(), stage: "delay-stage2" })
                );
              } catch (_) {}
            }
          }, 18000);
          window.addEventListener(
            "beforeunload",
            () => {
              clearTimeout(stage1);
              clearTimeout(stage2);
              try {
                localStorage.setItem(
                  "contactFlowLog",
                  JSON.stringify({ t: Date.now(), stage: "navigate-away" })
                );
              } catch (_) {}
            },
            { once: true }
          );
        });
      })();
    </script>
    <script>
      // デバッグ用: フォーム UI を触らずに AJAX 経由でテスト送信する関数
      // コンソールで window.testContactSubmission() を呼び出してください。
      window.testContactSubmission = async function () {
        const form = document.getElementById('contactForm');
        if (!form) { console.warn('form not found'); return; }
        if (!form.action || !form.action.includes('formsubmit.co/')) { console.warn('action not ready yet:', form.action); return; }
        const emailPart = form.action.split('formsubmit.co/')[1];
        const url = `https://formsubmit.co/ajax/${emailPart}`;
        const now = new Date();
        const stamp = now.toISOString();
        const fd = new FormData();
        // 必須フィールド最低限
        fd.append('inquiryType', 'business');
        fd.append('lastName', 'Test');
        fd.append('firstName', 'Auto');
        // 送信元メール（受信確認しやすいように）
        fd.append('email', 'test+' + Date.now() + '@example.com');
        fd.append('subject', 'デバッグ送信 ' + stamp);
        fd.append('message', '自動デバッグ送信: ' + stamp + '\nThis is a test payload.');
        fd.append('privacy', 'on');
        // 既存 hidden 相当
        fd.append('_subject', '【VALIARKサイト】デバッグ送信');
        fd.append('_captcha', 'false');
        fd.append('_honey', '');
        // _next は AJAX では使用しないが記録のため
        fd.append('_next', 'https://oztechjs.github.io/valiark/thanks.html');
        console.log('[testContactSubmission] POST', url);
        try {
          const res = await fetch(url, { method: 'POST', body: fd, headers: { 'Accept': 'application/json' } });
          const text = await res.text();
          console.log('[testContactSubmission] status:', res.status, 'ok:', res.ok); 
          console.log('[testContactSubmission] response snippet:', text.slice(0,500));
          localStorage.setItem('contactFlowLog', JSON.stringify({ t: Date.now(), stage: 'manual-test', status: res.status }));
          localStorage.setItem('contactFlowDebugResponse', text.slice(0,2000));
          if (res.status === 422) {
            console.warn('422: 未検証(verify)またはバリデーションエラーの可能性。送信先アドレスをブラウザで直接開いて認証を完了してください。');
          }
        } catch (e) {
          console.error('[testContactSubmission] error', e);
        }
      };
    </script>
  </body>
</html>
